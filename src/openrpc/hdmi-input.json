{
    "openrpc": "1.2.4",
    "info": {
        "title": "HDMIInput",
        "description": "Methods for managing HDMI inputs on an HDMI sink device.",
        "version": "0.0.0"
    },
    "methods": [
        {
            "name": "ports",
            "tags": [
                {
                    "name": "capabilities",
                    "x-uses": [
                        "xrn:firebolt:capability:inputs:hdmi"
                    ]
                }
            ],
            "summary": "Retrieve a list of HDMI input ports.",
            "params": [],
            "result": {
                "name": "ports",
                "schema": {
                    "$ref": "#/components/schemas/HDMIPort"
                }
            },
            "examples": [
                {
                    "name": "Default Example",
                    "params": [],
                    "result": {
                        "name": "ports",
                        "value": [
                            {
                                "port": "HDMI1",
                                "connected": true,
                                "arc": true,
                                "edidVersion": "2.0",
                                "autoLowLatencyMode": true
                            }
                        ]
                    }
                }
            ]
        },
        {
            "name": "devices",
            "tags": [
                {
                    "name": "capabilities",
                    "x-uses": [
                        "xrn:firebolt:capability:inputs:hdmi"
                    ]
                }
            ],
            "summary": "Retrieve a list of HDMI input devices.",
            "params": [],
            "result": {
                "name": "devices",
                "schema": {
                    "$ref": "#/components/schemas/HDMIDevice"
                }
            },
            "examples": [
                {
                    "name": "Default Example",
                    "params": [],
                    "result": {
                        "name": "devices",
                        "value": [
                            {
                                "port": "HDMI1",
                                "signal": "unknown",
                                "osdName": "PlayStation 4",
                                "cecVersion": "Version 2.0",
                                "logicalAddress": 4,
                                "physicalAddress": "1.2.3.4",
                                "arc": true,
                                "autoLowLatencyMode": true
                            }
                        ]
                    }
                }
            ]
        },
        {
            "name": "lowLatencyMode",
            "summary": "Property for the low latency mode setting.",
            "tags": [
                {
                    "name": "capabilities",
                    "x-uses": [
                        "xrn:firebolt:capability:inputs:hdmi"
                    ]
                },
                {
                    "name": "property"
                }
            ],
            "params": [
            ],
            "result": {
                "name": "enabled",
                "schema": {
                    "type": "boolean"
                }
            }
        },
        {
            "name": "onInputAutoLowLatencyModeChanged",
            "summary": "Notification for changes to ALLM status of any input device.",
            "tags": [
                {
                    "name": "capabilities",
                    "x-uses": [
                        "xrn:firebolt:capability:inputs:hdmi"
                    ]
                },
                {
                    "name": "event"
                } 
            ],
            "params": [
            ],
            "result": {
                "name": "data",
                "schema": {
                    "$ref": "#/components/schemas/AutoLowLatencyModeStatus"
                }
            }
        },
        {
            "name": "portAutoLowLatencyMode",
            "summary": "Property for each port auto low latency mode setting.",
            "tags": [
                {
                    "name": "capabilities",
                    "x-uses": [
                        "xrn:firebolt:capability:inputs:hdmi"
                    ]
                },
                {
                    "name": "property"
                }
            ],
            "params": [
                {
                    "name": "port",
                    "required": true,
                    "schema": {
                        "$ref": "#/components/schemas/HDMIPortId"
                    }
                }
            ],
            "result": {
                "name": "enabled",
                "schema": {
                    "type": "boolean"
                }
            }
        },
        {
            "name": "onInputSignalChanged",
            "summary": "Notification for changes to signal status of any input device.",
            "tags": [
                {
                    "name": "capabilities",
                    "x-uses": [
                        "xrn:firebolt:capability:inputs:hdmi"
                    ]
                },
                {
                    "name": "event"
                }                
            ],
            "params": [                
            ],
            "result": {
                "name": "status",
                "schema": {
                    "type": "object",
                    "properties": {
                        "port": {
                            "$ref": "#/components/schemas/HDMIPortId"
                        },
                        "signal": {
                            "$ref": "#/components/schemas/HDMISignalStatus"
                        }
                    },
                    "required": [
                        "port",
                        "signal"
                    ],
                    "additionalProperties": false
                }
            }
        },
        {
            "name": "onInputOSDNameChanged",
            "summary": "Notification for changes to OSD Name of any input device.",
            "tags": [
                {
                    "name": "capabilities",
                    "x-uses": [
                        "xrn:firebolt:capability:inputs:hdmi"
                    ]
                },
                {
                    "name": "event"
                }                
            ],
            "params": [                
            ],
            "result": {
                "name": "status",
                "schema": {
                    "type": "object",
                    "properties": {
                        "port": {
                            "$ref": "#/components/schemas/HDMIPortId"
                        },
                        "osdName": {
                            "type": "string"
                        }
                    },
                    "required": [
                        "port",
                        "osdName"
                    ],
                    "additionalProperties": false
                }
            }
        }        
    ],
    "components": {
        "schemas": {
            "HDMIPortId": {
                "type": "string",
                "pattern": "^HDMI[0-9]+$"
            },
            "HDMIPort": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                    "port": {
                        "$ref": "#/components/schemas/HDMIPortId"
                    },
                    "connected": {
                        "type": "boolean"
                    },
                    "arc": {
                        "type": "boolean"
                    },
                    "edidVersion": {
                        "type": "string",
                        "enum": [
                            "1.4",
                            "2.0",
                            "UNKNOWN"
                        ]
                    },
                    "autoLowLatencyMode": {
                        "type": "boolean"
                    }
                },
                "if": {
                    "properties": {
                        "edidVersion": {
                            "const": "2.0"
                        }
                    },
                    "required": [
                        "autoLowLatencyMode"
                    ]
                },
                "then": {
                    "required": [
                        "port",
                        "connected",
                        "arc",
                        "edidVersion"
                    ]
                },
                "required": [
                    "port",
                    "connected",
                    "arc",
                    "edidVersion"
                ]
            },
            "HDMIDevice": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                    "port": {
                        "$ref": "#/components/schemas/HDMIPortId"
                    },
                    "signal": {
                        "$ref": "#/components/schemas/HDMISignalStatus"
                    },
                    "arc": {
                        "type": "boolean"
                    },
                    "autoLowLatencyMode": {
                        "type": "boolean"
                    },
                    "cecVersion": {
                        "type": "string",
                        "enum": [
                            "Version 1.3a",
                            "Version 1.4",
                            "Version 2.0",
                            "unknown"
                        ]
                    },
                    "osdName": {
                        "type": "string"
                    },
                    "logicalAddress": {
                        "type": "integer",
                        "minimum": "0",
                        "maximum": "15"
                    },
                    "physicalAddress": {
                        "type": "string",
                        "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+\\.[0-9]+$"
                    }
                },
                "required": [
                    "port",
                    "signal",
                    "osdName",
                    "arc",
                    "autoLowLatencyMode",
                    "logicalAddress",
                    "physicalAddress",
                    "cecVersion"
                ]
            },
            "HDMISignalStatus": {
                "type": "string",
                "enum": [
                    "none",
                    "stable",
                    "unstable",
                    "unsupported",
                    "unknown"
                ]
            },
            "AutoLowLatencyModelStatus": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                    "port": {
                        "$ref": "#/components/schemas/HDMIPortId"
                    },
                    "autoLowLatencyMode": {
                        "type": "boolean"
                    }
                },
                "required": [
                    "port",
                    "autoLowLatencyMode"
                ]
            }
        }
    }
}