{
    "openrpc": "1.2.4",
    "info": {
        "title": "CertificationExtension",
        "description": "CertificationExtension provides various methods to get platform and/or app specific details which would be required for certification.",
        "version": "0.0.0"
    },
    "methods": [
        {
            "name": "onFireboltInteractions",
            "summary": "Event to fetch the interaction details for the firebolt api call",
            "tags": [
                {
                    "name": "event"
                },
                {
                    "name": "capabilities",
                    "x-provides": "xrn:firebolt:capability:certification:fireboltinteractions",
                    "x-allow-focus": true
                }
            ],
            "params": [],
            "result": {
                "name": "value",
                "summary": "Result of the interaction",
                "schema": {
                    "$ref": "#/components/schemas/InteractionResult"
                }
            },
            "examples": [
                {
                    "name": "Firebolt interaction to acquire device token",
                    "params": [],
                    "result": {
                        "name": "Default Result",
                        "value": {
                            "payload": "{\"request\":{\"type\":\"method\",\"method\":\"Authentication.device\"},\"response\":\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c\"}"
                        }
                    }
                }
            ]
        },
        {
            "name": "commandAndControl",
            "tags": [
                {
                    "name": "capabilities",
                    "x-uses": [
                        "xrn:firebolt:capability:certification:commandandcontrol"
                    ]
                }
            ],
            "summary": "Performs interaction and media control on firebolt compatible devices.",
            "params": [
                {
                    "name": "intent",
                    "required": true,
                    "summary": "An `PlatformIntent` with details what interaction or control needs to be performed.",
                    "schema": {
                        "$ref": "#/components/schemas/PlatformIntent"
                    }
                }
            ],
            "result": {
                "name": "success",
                "summary": "whether the call was successful or not",
                "schema": {
                    "type": "boolean"
                }
            },
            "examples": [
                {
                    "name": "Interact with the app and go to Menu screen",
                    "params": [
                        {
                            "name": "intent",
                            "value": {
                                "action": "button",
                                "data": {
                                    "operation": "menu"
                                },
                                "context": {
                                    "source": "voice"
                                }
                            }
                        }
                    ],
                    "result": {
                       "name": "Default Result",
                        "value": true
                    }
                }
            ]
        },
        {
            "name": "screenCapture",
            "tags": [
                {
                    "name": "capabilities",
                    "x-uses": [
                        "xrn:firebolt:capability:certification:screencapture"
                    ]
                }
            ],
            "summary": "Fetch the current screen on the device and upload to the given server",
            "params": [
                {
                    "name": "uploadPath",
                    "required": false,
                    "summary": "An optional `path` where screenshot can be uploaded. If not provided, base64 encoded image stream will be returned in the response.",
                    "schema": {
                        "type": "string"
                    }
                }
            ],
            "result": {
                "name": "success",
                "summary": "whether the call was successful or not",
                "schema": {
                    "oneOf": [
                        {
                            "type": "boolean"
                        },
                        {
                            "type": "string"
                        }
                    ]
                }
            },
            "examples": [
                {
                    "name": "Screen capture and sends back the image stream with base64 encoded",
                    "params": [],
                    "result": {
                        "name": "iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/wcAAgMBApDPF90AAAAASUVORK5CYII=",
                        "value": true
                    }
                },
                {
                    "name": "Screen capture and sends back the status",
                    "params": [
                        {
                            "name": "uploadPath",
                            "value": "http://example.com/upload"
                        }
                    ],
                    "result": {
                        "name": "Default Result",
                        "value": true
                    }
                }
            ]
        },
        {
            "name": "platformHealthCheck",
            "summary": "Health check for the device and process. It provides the load, memory, cpu usage and total live firebolt connections.",
            "tags": [
                {
                    "name": "capabilities",
                    "x-provides": "xrn:firebolt:capability:certification:healthcheck",
                    "x-allow-focus": true
                }
            ],
            "params": [],
            "result": {
                "name": "healthCheckResult",
                "summary": "Result of the interaction",
                "schema": {
                    "$ref": "#/components/schemas/HealthCheckResult"
                }
            },
            "examples": [
                {
                    "name": "Snapshots for the device and process",
                    "params": [],
                    "result": {
                        "name": "healthCheckResult",
                        "value": {
                            "cpuLoad1minAverage": 2.2,
                            "cpuLoad5minAverage": 1.8,
                            "deviceMemoryUsed": 886,
                            "deviceMemoryLimit": 1024,
                            "processMemoryPSS": 500,
                            "processMemoryRSS": 600,
                            "activeConnections": 10
                        }
                    }
                }
            ]
        },
        {
            "name": "appHealthCheck",
            "summary": "App healthCheck",
            "tags": [
                {
                    "name": "capabilities",
                    "x-provides": "xrn:firebolt:capability:certification:appperformancedata",
                    "x-allow-focus": true
                }
            ],
            "params": [
                {
                    "name": "appId",
                    "required": true,
                    "summary": "The id of the app for which the performance snapshot is required",
                    "schema": {
                        "type": "string"
                    }
                }
            ],
            "result": {
                "name": "appPerformanceResult",
                "summary": "Result of the interaction",
                "schema": {
                    "$ref": "#/components/schemas/AppPerformanceSnapshotResult"
                }
            },
            "examples": [
                {
                    "name": "Performance snapshot for the given app",
                    "params": [
                        {
                            "name": "appId",
                            "value": "foo"
                        }
                    ],
                    "result": {
                        "name": "appPerformanceResult",
                        "value": {
                            "memory": 0.5,
                            "cpu": 0.5
                        }
                    }
                }
            ]
        }
    ],
    "components": {
        "schemas": {
            "InteractionResult": {
                "title": "InteractionResult",
                "type": "object",
                "required": [
                    "payload"
                ],
                "properties": {
                    "payload": {
                        "type": "string",
                        "description": "The stringyfy payload of the interaction contains firebolt api request and response"
                    }
                }
            },
            "PlatformIntent": {
                "title": "PlatformIntent",
                "description": "A Firebolt compliant representation of a user intention to interact to a specific place in an app or control the media",
                "anyOf": [
                    {
                        "$ref": "https://meta.comcast.com/firebolt/intents#/definitions/DeviceIntent"
                    }
                ]
            },
            "HealthCheckResult": {
                "title": "HealthCheckResult",
                "description": "Performance and healthcheck snapshot for the device and process which includes load, memory, cpu usage. It also provides total live firebolt connections.",
                "type": "object",
                "required": [
                    "cpuLoad1minAverage",
                    "cpuLoad5minAverage",
                    "deviceMemoryUsed",
                    "deviceMemoryLimit",
                    "processMemoryPSS",
                    "processMemoryRSS",
                    "activeConnections"
                ],
                "properties": {
                    "cpuLoad1minAverage": {
                        "type": "number",
                        "description": "The load average of the system for 1 min, typically known as short term load."
                    },
                    "cpuLoad5minAverage": {
                        "type": "number",
                        "description": "The load average of the system for 5 min, typically known as mid term load."
                    },
                    "processMemoryPSS": {
                        "type": "number",
                        "description": "Process memory usage as proportional set size (PSS) in KB. This data provides a way to account for memory shared between processes more accurately"
                    },
                    "processMemoryRSS": {
                        "type": "number",
                        "description": "Process memory usage as resident set size (RSS) in KB. It represents the portion of a process's memory that is held in RAM"
                    },
                    "deviceMemoryUsed": {
                        "type": "number",
                        "description": "The memory usage of the device"
                    },
                    "deviceMemoryLimit": {
                        "type": "number",
                        "description": "Total memory limit of the device"
                    },
                    "activeConnections": {
                        "type": "number",
                        "description": "The total number of active firebolt connections"
                    }
                }
            },
            "AppPerformanceSnapshotResult": {
                "title": "AppPerformanceSnapshotResult",
                "description": "Performance snapshot for the given appId which includes memory usage, cpu usage.",
                "type": "object",
                "required": [
                    "memory",
                    "cpu"
                ],
                "properties": {
                    "memory": {
                        "type": "number",
                        "description": "The memory usage of the app"
                    },
                    "cpu": {
                        "type": "number",
                        "description": "The cpu usage of the the app"
                    }
                }
            }
        }
    }
}